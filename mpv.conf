window-maximized=yes
profile=high-quality # fast, high-quality, default

[fs]
profile-cond=fullscreen
# profile-restore=copy
script-opt=osc-boxvideo=no
script-opt=osc-visibility=auto

[nfs]
profile-cond=not fullscreen
# profile-restore=copy
script-opt=osc-boxvideo=yes
script-opt=osc-visibility=always

##################
# Video Profiles #
##################
vo=gpu-next  # gpu, gpu-next, drm

# D3D11
# hwdec=no # d3d11va-copy, d3d11va, d3d12va
# d3d11-adapter=NVIDIA GeForce RTX 3060 Ti
# gpu-api=d3d11
# gpu-context=d3d11

# VULKAN
hwdec=vdpau
gpu-api=vulkan
gpu-context=x11vk
vulkan-async-compute=no # disable if using nvidia GPU
# vulkan-device=NVIDIA GeForce RTX 3060 Ti

#################
# VIDEO SCALING #
#################
# Luma upscaler
scale=spline36

# Chroma up & downscaler
cscale=spline36

# Luma downscaler
dscale=hermite  # https://github.com/mpv-player/mpv/wiki/Downscaling-with-Hermite

correct-downscaling=yes
linear-downscaling=yes
sigmoid-upscaling=yes

######################
# VIDEO ENHANCEMENTS #
######################
brightness=0
saturation=0
gamma=0
contrast=0

#############
# DITHERING #
#############
# dither-depth=no # auto, no, 8, 10
# dither=no  # no, fruit, error-diffusion
# temporal-dither=no

dither-depth=auto # auto, no, 8, 10
dither=fruit  # no, fruit, error-diffusion
dither-size-fruit=8
temporal-dither=yes
temporal-dither-period=1

#############
# DEBANDING #
#############
deband=no  # only turn on for videos with banding - reduces detail slightly..
# deband=yes  # only turn on for videos with banding
# deband-iterations=4  # https://mpv.io/manual/stable/#options-deband-iterations
# deband-threshold=35  # https://mpv.io/manual/stable/#options-deband-threshold
# deband-range=24      # https://mpv.io/manual/stable/#options-deband-range
# deband-grain=5       # https://mpv.io/manual/stable/#options-deband-grain

#############
# INTERFACE #
#############
# border=no # show windows titlebar instead of mpv default
osd-font='Roboto'  # ui font
osd-font-size=8
osd-bar=no  # Don't show a huge volume box on screen when turning the volume up/down
osd-bold=yes

##########
# IMAGES #
##########
image-display-duration=inf  # dont cycle through images

#########
# AUDIO #
#########
# ao=alsa
# audio-device='alsa/hdmi:CARD=NVidia,DEV=0'
audio-channels=auto

# set initial and maximum volume
volume=100
volume-max=100

# based on # https://blog.otterbro.com/ffmpeg-audio-channel-manipulation/
# downmix to 3.0
af-append=pan="3.0|FL=FL+0.5*SL+0.5*BL+0.5*LFE|FR=FR+0.5*SR+0.5*BR+0.5*LFE|FC=FC"
# af-append=format=channels=3.0

# manual loudnorm filter
# af-toggle=lavfi=[loudnorm=I=-16:TP=-1.5:LRA=7:measured_I=-16.5:measured_LRA=23.6:measured_TP=-0.0:measured_thresh=-29.3]

# https://github.com/mpv-player/mpv/issues/8418#issuecomment-2466772516
# https://ffmpeg.org/ffmpeg-filters.html#dynaudnorm
af-append=lavfi="dynaudnorm=targetrms=0.5:framelen=1000:gausssize=53"
# af-append=lavfi="dynaudnorm=targetrms=0.5:gausssize=53"
# af-append=lavfi="lowshelf=frequency=100:gain=-2.5,dynaudnorm=compress=27.0:gausssize=53"

# https://github.com/mpv-player/mpv/issues/9979#issuecomment-1068338756
# https://www.reddit.com/r/mpv/comments/1l5n8gr/best_settings_for_smplayer_2025_update_gpunext/
# af-append=lavfi=[firequalizer=gain='gain_interpolate(f)':delay=0.027:accuracy=1:wfunc=bharris:gain_entry='entry(31,5.0);entry(40,5.0);entry(41,5.0);entry(50,5.0);entry(100,5.0);entry(200,5.0);entry(392,5.0);entry(523,5.0)':scale=linlog]

# https://ffmpeg.org/ffmpeg-filters.html#acompressor
# copy of VLC's acompressor - https://www.vlchelp.com/fix-movies-loud-music-low-dialogue/
# note: value = 10**(dB/20)
# af-append=acompressor=threshold=0.06456542290346556:ratio=20:attack=24.9:release=262.9:knee=1.1885022274370185 # :makeup=2.371373705661655
# https://www.reddit.com/r/VLC/comments/sr7oyh/movies_dialogues_are_too_quiet_and_sound_effects
# af-append=acompressor=threshold=0.06456542290346556:ratio=20:attack=25:release=260.5:knee=1.202264434617413 # :makeup=2.371373705661655


#############
# SUBTITLES #
#############
# sid=no  # disable showing subtitles by default
sub-ass-override=force # force styling
blend-subtitles=yes
sub-auto=fuzzy  # external subs don't have to match the file name exactly to autoload

# display forced subs only else none
# sub-forced-events-only=yes

sub-font="Ubuntu Regular"
# sub-font="Noto Sans JP Thin"
sub-font-size=30
sub-border-size=2

# BLURAY-esque style # https://www.reddit.com/r/mpv/comments/uzvm8i/comment/iaj43n3/
# sub-font='Arial Regular'
# sub-border-size=1
# sub-color='#CDCDCD'
# sub-shadow=3
# sub-shadow-color='#000000'
# sub-shadow-offset=2

# remove hearing impared subtitles
# sub-filter-sdh=yes
# sub-filter-sdh-harder=yes

######################
# LANGUAGE SELECTION
######################
# For anime we want to load JP audio with ENG subs.
# alang=English,eng,en
# slang=English,eng,en

alang=Japanese,jpn,ja,English,eng,en
slang=Japanese,jpn,ja,English,eng,en  # for immersion learning

#################
# INTERPOLATION #
#################
video-sync=display-resample  # audio, display-resample, display-vdrop, display-tempo
interpolation=yes

# interpolation-threshold=-1
# video-sync-max-video-change=5
# video-sync-max-factor=10

# https://en.wikipedia.org/wiki/Mitchell%E2%80%93Netravali_filters
# slightly softer than standard B=C=1/3
# tscale=mitchell
# scale-param1=0.5  # B
# scale-param2=0.5  # C
# tscale-clamp=0.2
# tscale-antiring=0.2
# tscale-blur=0.7
# tscale-window=sphinx

# tscale=mitchell
# scale-param1=0.8  # B
# scale-param2=0.1  # C
# tscale-clamp=0.0
# tscale-antiring=0.0
# tscale-blur=0.65
# tscale-window=sphinx

tscale=gaussian
scale-param1=0.1353352832366127 # 0.1353352832366127  # 1/e**2, 0.36787944117144233 1/e
tscale-clamp=0
tscale-antiring=0
tscale-blur=0.55
# tscale-radius=2.718281828459045  # e
tscale-window=sphinx

# https://github.com/mpv-player/mpv/issues/9427#issuecomment-963522463
# tscale=sphinx
# # tscale-radius=0.49
# tscale-blur=0.6991556596428412

# tscale=sphinx
# tscale-blur=0.6991556596428412
# tscale-radius=1.05
# tscale-clamp=0.0

####################
# DISPLAY SETTINGS #
####################
# https://kodi.wiki/view/Video_levels_and_color_space
# following "limited -> full -> limited" chain
# video-output-levels=limited  # full, limited, auto

#######
# SDR #
#######
[SDR]
osd-playing-msg="SDR"
profile-cond=get("video-params/primaries") == "bt.709"
# profile-restore=copy

# set appropiate targets tailored for !!!!OUTPUT DISPLAY!!!!
video-output-levels=full  # full, limited, auto
target-prim=bt.709 # bt.2020, dci-p3, bt.709
target-trc=bt.1886 # bt.1886, gamma2.2

# [720p]
# osd-playing-msg="720p"
# profile-restore=copy
# profile-cond=height==720
# vf-add=d3d11vpp=scale=4:scaling-mode=nvidia:format=nv12

######
# 3D #
######
# https://ffmpeg.org/ffmpeg-filters.html#stereo3d
# HSBS  --> Alternating
# vf=lavfi="[stereo3d=in=sbs2l:out=hdmi]"
# vf=lavfi="stereo3d=in=sbs2l:out=hdmi"
# vf=lavfi="stereo3d=sbs2l:hdmi"
# vf=stereo3d=sbs2l:ml
# vf=format:stereo-in=sbs2l

#######
# HDR #
#######
[HDR]
osd-playing-msg="HDR"
profile-cond=get("video-params/primaries") == "bt.2020"
# profile-restore=copy

video-output-levels=full  # full, limited, auto

# target-colorspace-hint=auto

# glsl-shader=~~/shaders/aces.glsl

# only change for HDR/tone-mapping
target-peak=200 # 203 default for SDR (hisense=300 peak)
target-contrast=4723  # 4723, inf

hdr-compute-peak=yes

libplacebo-opts=color_map_preset=high_quality,lut3d_tricubic=yes,gamut_expansion=yes,peak_detect=yes,peak_percentile=99.995,contrast_recovery=0,gamut_mapping=perceptual,tone_mapping=st2094-40,knee_adaptation=0.5,knee_minimum=0,knee_maximum=1,knee_default=0.5
# libplacebo-opts=color_map_preset=high_quality,lut3d_tricubic=yes,gamut_expansion=yes,peak_detect=yes,peak_detection_preset=high_quality,peak_percentile=99.995,contrast_recovery=0,gamut_mapping=perceptual,tone_mapping=spline,knee_adaptation=1,knee_minimum=0,knee_maximum=1,knee_default=0.5,slope_tuning=0,slope_offset=0#,perceptual_deadzone=0.5,perceptual_strength=0.5

# libplacebo-opts=color_map_preset=high_quality,lut3d_tricubic=yes,gamut_expansion=yes
# libplacebo-opts=peak_detect=yes,peak_detection_preset=high_quality,peak_percentile=99.995,contrast_recovery=0
# # # libplacebo-opts=gamut_mapping=perceptual,tone_mapping=spline
# # # libplacebo-opts=gamut_mapping=perceptual,tone_mapping=bt2446a
# # # libplacebo-opts=gamut_mapping=perceptual,tone_mapping=bt2390
# # # libplacebo-opts=gamut_mapping=perceptual,tone_mapping=st2094-10
# # # libplacebo-opts=gamut_mapping=perceptual,tone_mapping=st2094-40
# # # libplacebo-opts=gamut_mapping=perceptual,tone_mapping=st2094-40,knee_adaptation=0,knee_minimum=0,knee_maximum=1,knee_default=0.5
# # # libplacebo-opts=gamut_mapping=perceptual,tone_mapping=spline,slope_tuning=10,slope_offset=0
# libplacebo-opts=gamut_mapping=perceptual,tone_mapping=spline,knee_adaptation=1,knee_minimum=0,knee_maximum=1,knee_default=0.5,slope_tuning=0,slope_offset=0
# # # libplacebo-opts=gamut_mapping=perceptual,tone_mapping=st2094-40,knee_adaptation=1,knee_minimum=0,knee_maximum=1,knee_default=0.5

# disable DV
# vf-add=format:dolbyvision=no
